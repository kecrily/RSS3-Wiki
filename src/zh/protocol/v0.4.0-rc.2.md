<!-- # RSS3 Protocol v0.4.0-rc.2 -->

## 1. 摘要

创造、传播和分发信息的权利属于人们，它不应被中心化平台所掌控。这是网络时代人们生活所需最基本的权利。

在过去的 20 年里，内容及其传播渠道逐渐被几个数据寡头所控制，这形成了一种有害的中心化氛围，为了利润而牺牲了隐私和自由，这种氛围进一步阻碍了创新：无论你的设计和程序写得有多好，你的应用程序都无法与数据垄断者公平竞争。

世界始终渴望一种崭新的信息聚合方式。RSS 曾是那个时代的先锋，现在是时候由我们接过接力棒并继续前进探索了。

取 RSS 之精华而成的 RSS3 是一个开放的信息组织分发协议，致力于在 Web3 中高效和去中心化地传播信息。 它定义了信息存在和交流的格式，通过这种设计优雅、用户友好的内容格式，客户可以轻松地以统一的格式访问各种内容源，而不需要大量的兼容逻辑。

## 2. 文档状态

虽然理论上本协议已完备，但该版本仍处于 beta 阶段，需要在实际应用中检验。因此，团队无法保证本文档与后续版本相互兼容，但会尽量在后续更新中保持连贯性。

## 3. 依赖

- [RFC 3986 - Uniform Resource Identifier (URI): Generic Syntax](https://datatracker.ietf.org/doc/html/rfc3986): The protocol uses a large number of RFC 3986 Uniform Resource Identifiers to identify things in RSS3.
- [RFC 6838 - Media Type Specifications and Registration Procedures](https://datatracker.ietf.org/doc/html/rfc6838): The value of the item.attachment.mime_type field in the protocol uses the RFC 6838 standard.
- [JSON Schema: A Media Type for Describing JSON Documents](https://datatracker.ietf.org/doc/html/draft-bhutton-json-schema-00): The protocol provides the user with a series of JSON Schema to do format validation.
- [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601): All times appearing in the protocol use the extended ISO 8601 format with 3 decimals (YYYY-MM-DDTHH:mm:ss.sssZ).

## 4. 主要概念

### 4.1. Accounts

为了保持开放和兼容，本协议不会创建一个新的账号系统。本协议兼容现存各个平台的账号系统，包括加密技术体系下非中心化的平台和中心化平台。

有两种账号

主账号：实体 URI 中的账号，代表拥有者和文件签名人，且必须来自非中心化平台。

- 关联账号：`profile.account` 字段中的账号，代表属于实体的其它账号。

一个账号包含两份信息：账号 ID 和账号所属的平台。

```xsl
Account = <identity>@<account_platform>
```

- `identity` 是平台中的唯一账号 ID；
- `account_platform` 由 [RSS3 改进提案-1: 在册用户平台](./RIPs/RIP-1.md) 定义。

如，
- 一个以太坊账号表示为 `0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum`。

- 一个 Twitter 账号表示为 `DIYgod@twitter`。

### 4.2. 文件

RSS3 网络返回数据，用户使用符合 RSS3 标准的 JSON 文件提交数据。

RSS3 文件的 mime 类型是 `application/rss3+json`。 建议在 RSS3 文件的响应头中包含 `content-type: application/rss3+json; charset=utf-8`。

每个文件具有一些共有属性。

```ts
type FileBase<URIType, ElementType> = {
    version: 'v0.4.0';
    date_updated: string;

    identifier: URIType;
    identifier_next?: URIType;

    total: number;
    list?: ElementType[];
}
```

#### 4.2.1. `version`

协议版本，当前版本是 `v0.4.0`。

#### 4.2.2. `date_updated`

文件的更新时间，格式为扩展的 ISO 8601，带 3 位小数（YYY-MM-DDTHH:mm:ss.ssZ）。

#### 4.2.3. `identifier`

该协议使用一些符合 [RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986) 标准的统一资源标识符（URI）来标识 RSS3 中的事物，如实例标识符、项目标识符和列表标识符。RSS3 的 URI 可以被用户用来访问它所代表的项目或作为链接的目标。

##### 4.2.3.1. Scheme

Scheme 是`rss3`。也就是说，RSS3 的 URI 以 `rss3:// `开头。

##### 4.2.3.2. 鉴权

此协议使用实例进行鉴权

一个实例是一个 RSS3 交互性对象和一个 RSS3 存在单元。

```xsl
Instance = <prefix>:<identity>@<platform>
```

- `prefix` 是 `account`, `asset`, `note` 的一个常数。
- `platform` 是实例所属的平台。账号的平台由 [RIP-1: 在册账号平台](./RIPs/RIP-1.md) 定义，物品的平台由 [RIP-3: 在册物品网络](./RIPs/RIP-3.md) 和 [RIP-4: 在册索引物品](./RIPs/RIP-4.md) 定义。
- `identity` 是该平台上实例的唯一 ID。

###### 4.2.3.2.1. 账号实例

账号实例是用一个账号创建的实例。

```xsl
AccountInstance = account:<account_identity>@<account_platform>
```

如，
- `account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum`
- `account:DIYgod@twitter`

###### 4.2.3.2.2. 项目实例

项目实例是 Item 的一个实例。

```xsl
ItemInstance = {asset|note}:<metadata_proof>@<item_network>
```

如，
- `asset:0xacbe98efe2d4d103e221e04c76d7c55db15c8e89-5@ethereum`

##### 4.2.3.3. URI

下面说明了每个 URI 的组成部分。

###### 4.2.3.3.1. 实例 URI

```xsl
InstanceURI = AccountInstanceURI | ItemInstanceURI

AccountInstanceURI = rss3://<AccountInstance>
ItemInstanceURI = rss3://<ItemInstance>
```

示例：

- 账号实例 URI

    ```text
    rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum
    ```

- 资产实例 URI

    ```text
    rss3://asset:0xb9619cf4f875cdf0e3ce48b28a1c725bc4f6c0fb-1024@ethereum
    ```

- 帖子实例 URI

    ```text
    rss3://note:1483972580616949762@twitter
    ```

###### 4.2.3.3.2. Items URI

```xsl
ItemsURI = rss3://<Instance>/{notes|assets}[?<query_string>]
```

> 请参考 [项目](#_4-5-项目)以了解更多。

可用参数：

| Key | Usage |
| --- | --- |
| limit | 用于分页，限制返回项目的数量。实施时应该有一个最大值和最小值。|
| last_time | 用于分页。一个 ISO 8601 的时间。如果指定，只返回这个时间之前的项目。|
| filter_tags | 如果指定，只返回相应标签的项目（使用项目的 `tags` 属性过滤）。多个值用逗号分隔。|
| filter_network | 如果指定，只返回过滤器列表中带有 `metadata.network` 字段的项目。多个值用逗号隔开。|
| filter_mime_types | 如果指定，只返回包含有 `attachments.mime_type` 字段的项目的相应值。多个值用逗号分隔。|
| link_type and link_network | 如果指定，只返回相应链接目标的项目。|

示例：,

- 前 5 个帖子列表

    ```text
    rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/notes?limit=5
    ```

- 从该实例的 crossbell 以下实例的帖子列表。

    ```text
    rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/notes?link_type=following&link_network=crossbell
    ```

###### 4.2.3.3.3. 链接列表 URI

```xsl
LinkListURI = rss3://<Instance>/links/<link_type>[?<query_string>]
```

`link_type` is defined by [RIP-5: Registered 链接 Types](./RIPs/RIP-5.md).

可用参数：

| Key | Usage |
| --- | --- |
| limit | 用于分页，限制返回项目的数量。实施时应该有一个最大值和最小值。|
| last_instance | 用于分页。如果指定，则返回此实例之后的实例。|
| instance | 如果指定，只返回包含此实例的列表。如果指定了，但没有满足的列表，则返回 null。|
| filter_network | 如果指定，只返回过滤器列表中带有`metadata.network`字段的链接。多个值用逗号分隔。|

示例：

- The following 链接 list of the first 5 instances:

    ```text
    rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/links/following?limit=5
    ```

- 查询一个实例后面是否有另一个实例。

    ```text
    rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/links/following?instance=0x8768515270aA67C624d3EA3B98CA464672C50183%40ethereum
    ```

###### 4.2.3.3.4. 反链列表 URI

```xsl
BacklinkListURI = rss3://<Instance>/backlinks[?<query_string>]
```

可用参数：

| 关键 | 用途 |
| --- | --- |
| 类型 | 只返回此类型的反链。|
| limit | 用于分页，限制返回项目的数量。实施时应该有一个最大值和最小值。|
| last_instance | 用于分页。如果指定，则返回此实例之后的实例。|
| instance | 如果指定，只返回包含此实例的列表。如果指定了，但没有满足的列表，则返回 null。|
| filter_network | 如果指定，只返回过滤器列表中带有`metadata.network`字段的链接。多个值用逗号分隔。|

示例：

- 显示前 5 个实例的列表。

    ```text
    rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/backlinks?type=following&limit=5
    ```

- 查询一个实例是否在跟踪另一个实例。

    ```text
    rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/backlinks?type=following&instance=0x8768515270aA67C624d3EA3B98CA464672C50183%40ethereum
    ```

- 一个一帖子评论。

    ```text
    rss3://note:1483972580616949762@twitter/backlinks/comment
    ```

##### 4.2.3.4. `identifier_next`

标识下一页的 URI。 若未指定，默认当前页是最后一页。

如：

```json
{
    "identifier":      "rss3://account:0xtest@ethereum/notes?limit=5",
    "identifier_next": "rss3://account:0xtest@ethereum/notes?limit=5&last_time=2022-01-01T00:00:00Z"
}
```

#### 4.2.4. `total`

当前页和下一页的元素的总数。

#### 4.2.5. `list`

列表元素，根据列表文件的类型可以分为资料、项目、链接、反链等。

### 4.3. 项目

项目是由一个实例自动或被动产生的操作或物品。该协议无法预测会有哪些类型的内容，因此该协议努力将其定义得更加宽泛和无限制。它可能是一篇博文，一个 NFT，或者一个商品，一个游戏活动，等等。

#### 4.3.1. 项目类型

##### 4.3.1.1. According to source

- 被索引的项目。RSS3 网络根据主账号和关联账号从其他网络或平台自动索引的项目，如 [RIP-4：在册索引的项目](./RIPs/RIP-4.md) 中定义。

- 自定义项目。由用户自己签署和提交的项目。

##### 4.3.1.2. According to content

- 资产。它们是实例所拥有的资产，也可以根据不同的使用场景扩展和解释为任何固定的展示内容，如一个 NFT、一个游戏成就、一个物理数字、一个出售的商品等等。

- 帖子。它们是实例产生的操作或事件，也可以根据不同的使用场景扩展和解释为任何 feed 的内容，如写一篇博文、获得一个 NFT 动态、写一篇论坛帖子、发表对其他项目的回复等等。

#### 4.3.2. Item Overall

在一个索引文件中可以看到项目的结构。

```ts
type ItemsSet = {
    notes: {
        identifier_custom?: CustomItemListURI;
        identifier: AggregatedItemListURI;
        filters?: Filters;
    };
    assets: {
        identifier_custom?: CustomItemListURI;
        identifier: AggregatedItemListURI;
        filters?: Filters;
    };
};
```

##### 4.3.2.1. `items.assets`

`assets` 是实例所拥有的物品，根据不同的使用场景，也可以扩展和解释为任何固定的展示内容，如 NFT、游戏成就、实物图、出售的商品等。

##### 4.3.2.2. `items.notes`

`note` 是实例产生的操作或事件，也可以根据不同的使用场景扩展和解释为任何 feed 内容，如写一篇博客文章，获得一个 NFT 动态，写一个论坛帖子，发布一个对其他项目的回复等。

##### 4.3.2.3. `items.x.identifier_custom`

`identifier_custom` 记录的是最后一页的自定义项目列表的 URI，列表元素是用户自己提交的项目。

当只有一页内容时，`identifier_custom` 的值是 `rss3://<Instance>/list/{note|asset}/0`，直到内容超过 RSS3 网络规定的文件大小限制。然后，新的项目被记录在一个新的文件中，其 URI 为 `rss3://<Instance>/list/{note|asset}/1`，`identifier_custom`字段被改为`rss3://<Instance>/list/{note|asset}/1`。

##### 4.3.2.4. `items.x.identifier`

`identifier` 是聚合项目列表的 URI，它包含自定义项目和索引项目，按 `date_created` 排序，最新的在最上面。它支持一些查询。

##### 4.3.2.5. `items.x.filters`

`filters` 用于过滤由 `identifier` 返回的**索引项目**，以满足用户选择性显示的需要。

它对 `item.tags`和`item.metadata.network`进行过滤。

```ts
type Filters = {
    blocklist?: string[];
    allowlist?: string[];
}
```

###### 4.3.2.5.1. `items.x.filters.blocklist`

禁止在此列表中含有字段的项目或反链被返回，例如：`blocklist: ["twitter"]`，在这种情况下，AggregatedItemListURI 将不会返回 `item.tags` 和 `item.metadata.network` 值为 `twitter` 的项目。

###### 4.3.2.5.2. `items.x.filters.allowlist`

只有在这个列表中包含字段的项目或反链才允许被返回。如果有一个允许列表，那么这个封锁列表将是无效的。如，如果 `allowlist: ["twitter"]`，那么 AggregatedItemListURI 将只返回` item.tags` 和 `item.metadata.network` 值为 `twitter` 的条目。

#### 4.3.3. 项目细节

```ts
type Item = {
    identifier: ItemInstanceURI;
    date_created: string;
    date_updated: string;

    auto?: true;
    related_urls?: string[];

    links: LinksSet;

    tags?: string[];
    authors: Account[];
    title?: string;
    summary?: string;
    attachments?: Attachment[];

    metadata?: {
        network: NetworkName;
        proof: string;

        [key: string]?: any;
    };
};
```

##### 4.3.3.1. `item.date_created`

操作或项目产生的时间，采用 ISO 8601 的格式，如文章发表的时间、NFT 铸造时间、产品上架的时间、获得 NFT 的时间（在帖子中表示操作产生的时间）等。

##### 4.3.3.2. `item.date_updated`

操作或项目变更的时间，格式为 ISO 8601，如物品修改时间、NFT 的获取时间（在资产中，表示项目变更的时间）等。

##### 4.3.3.3. `item.auto`

如果为真，意味着这是一个索引项目，而不是一个自定义项目。

##### 4.3.3.4. `item.related_urls`

仅适用于自定义项目。与项目相关的链接，如项目在索引网络中的地址。

##### 4.3.3.5. `item.identifier`

`identifier`是项目的 URI。参见 [实例 URI](#_4-3-1-instance-uri)。

##### 4.3.3.6. `item.links`

详见[链接](#_4-6-链接).

##### 4.3.3.7. `item.tags`

`tags`是一个字符串的数组。类似于个人博客中常用的标签概念，你可以在一篇文章中添加多个标签；索引项目也会有标签，表示项目的类型，具体值在 [RIP-4：在册索引项目](./RIPs/RIP-4.md) 中有限制。

##### 4.3.3.8. `item.authors`

`authors`数组包含账号，表示产生这个项目的账号，如文章的作者、产品的卖家等。如果是当前的实例地址，可以省略。

如果该项目是一个索引项目，并且作者是一个关联账号，它将额外包含主账号。

##### 4.3.3.9. `item.title` and `item.summary`

`summary`的内容不能太长，RSS3 网络应设定最大长度。

如果是短的内容，那么它很可能只有 `summary` 而没有 `title`，例如 Twitter 的 Tweet。

如果它是一篇长文章，而且字数超过了大小限制，那么它的`摘要`应该只是文章的摘要或截断，完整的内容应该放在`附件`中。

##### 4.3.3.10. `item.attachments`

`attachments` 记录这个项目的附件，如文章的图片等。如果是一篇长文章，它也可能包含文章的全文。

包含附件的数组。每个元素的结构是：

```ts
type Attachment = {
    type?: string;
    content?: string;
    address?: URI;
    mime_type: string;
    size_in_bytes?: number;
}
```

###### 4.3.3.10.1. `item.attachments[i].type`

附件的类型，表示这个附件的功能或分类，如缩略图、详细描述等。

这个值可以是任何字符串。

###### 4.3.3.10.2. `item.attachments[i].content` and `item.attachments[i].address`

`content` 是附件的实际内容，如文章的全部内容或图片的 base64 字符串。这个字段的内容可能很长，但 RSS3 网络应限制内容的最大长度，以免影响整个网络的存储效率。超过最大长度限制的内容应使用第三方存储放在地址栏中。

`address`是这个附件的 URI，指向第三方地址，如 markdown 文件地址或图片地址。

`content` 和 `address` 相斥，一个附件只能有一种。

###### 4.3.3.10.3. `item.attachments[i].mime_type`

这记录了这个附件的媒体类型。该格式必须符合 RFC 6838 标准，如 `image/png`、`text/markdown` 等。从应用展示的角度来看，这是一个重要但容易被忽视的字段，所以协议将其规定为一个必填字段。

###### 4.3.3.10.4. `item.attachments[i].size_in_bytes`

这记录了这个附件的大小，单位是字节。它对于显示大文件如视频和音频很有用。这也是一个容易被忽视的字段。该协议建议尽可能确保这个字段的存在和准确性。

##### 4.3.3.11. `item.metadata`

这记录了索引项目的元数据，具体值由 [RIP-4: 在册索引项目](./RIPs/RIP-4.md)所规定。

###### 4.3.3.11.1. `item.metadata.network`

这个项目被存储的网络。

它的值由 [RIP-3: 在册项目网络] (./RIPs/RIP-3.md)所规定。

###### 4.3.3.11.2. `item.metadata.proof`

这记录了为这个索引项建立索引的凭证，如交易哈希值和中心化平台的地址。

### 4.4. Link

这描述了 RSS3 中两个实例或项目之间的关系。

#### 4.4.1. 项目类型

- 被索引的链接。RSS3 网络根据主账号和关联账号从其他网络或平台自动索引的链接。

- 自定义链接。由用户自己签署和提交的链接，或由索引项目实例自动索引的链接。

#### 4.4.2. 链接 Overall

实例和项目中都由 `links` 字段。

```ts
interface LinksSet {
    identifiers?: {
        type: LinkType;
        identifier_custom: CustomLinkListURI;
        identifier: AggregatedLinkListURI;
    }[];
    identifier_back: BacklinkListURI;
}
```

##### 4.4.2.1. `links.identifiers.type`

关系的类型，例如实例的跟随关系、项目的关注关系等。具体值由 [RIP-5: Registered 链接类型](./RIPs/RIP-5.md) 所限定。

##### 4.4.2.2. `links.identifiers.identifier_custom`

这记录了最后一页的自定义链接列表的 URI。

当只有一页内容时，`identifier_custom` 的值是 `rss3://<Instance>/list/link/0'，直到内容超过 RSS3 网络规定的文件大小限制，然后新的链接被记录在一个新的文件中，其 URI 是`rss3://<Instance>/list/link/1'，并将`identifier_custom` 字段改为 `rss3://<Instance>/list/link/1`。

##### 4.4.2.3. `links.identifiers.identifier`

这是聚合链接列表的 URI，它支持一些查询。

##### 4.4.2.4. `links.identifier_back`

这记录了这个链接的反向关系。如，如果 A 记录了对 B 的跟随关系，那么 B 的 `identifier_back` 将自动记录 A 的反向跟随（即被跟随）关系。

#### 4.4.3. 链接 Details

```ts
type 链接= {
    identifier_target: InstanceURI;
    type: LinkType;

    auto?: true;
    metadata?: Metadata;
};
```

##### 4.4.3.1. `link.identifier_target`

链接目标是一个 RSS3 URI，它可以是实例 URI 或项目 URI。这意味着用户可以关注其他 RSS3 账号，并对 RSS3 资产或 RSS3 帖子进行评论。

##### 4.4.3.2. `link.type`

See [links.identifier_back](#_4-6-2-4-links-identifier-back).

### 4.5. Profile

简介位于索引文件的 `profile` 字段中，它记录了实例的基本信息，包括名称、头像、简介等。

```ts
type Profile = {
    name?: string;
    avatars?: URI[];
    bio?: string;
    attachments?: Attachment[];

    accounts?: Accounts;

    tags?: string[];
    metadata?: Metadata;
};
```

#### 4.5.1. `profile.name`

实例的名称，如用户的显示名称、资产标题。

#### 4.5.2. `profile.avatars`

实例图标，如用户的头像和资产图像，可以同时设置多个，应用程序一般应选择第一个显示。

#### 4.5.3. `profile.bio`

对该实例的文字介绍。

#### 4.5.4. `profile.attachments`

当用于项目实例时，与 [item.attachments](#_4-5-3-10-item-attachments) 相同。

当用于账号实例时，`profile` 是一个非常灵活和多样化的信息。该协议不能预测所有的要求，所以只定义了一些最常用的信息，希望使用 `attachments` 字段来记录没有明确定义的资料信息，如 `websites`、`banner`。

如：

```json
{
    "attachments": [
        {
            "type": "websites",
            "content": "https://rss3.io\nhttps://diygod.me",
            "mime_type": "text/uri-list",
        },
        {
            "type": "banner",
            "content": "ipfs://QmT1zZNHvXxdTzHesfEdvFjMPvw536Ltbup7B4ijGVib7t",
            "mime_type": "image/jpeg",
        }
    ]
}
```

#### 4.5.5. `profile.accounts`

这是另一个 [账号](#_4-2-账号)，用于记录实例绑定，包括基于密码学的去中心化和中心化平台的账号。

```ts
type Accounts = {
    identifier: AccountInstanceURI;
    signature?: string;
}[];
```

##### 4.5.5.1. `profile.accounts[i].identifier`

账号的 URI。如果是基于密码学的去中心化账号，则使用`profile.accounts[i].signature`来验证所有权。如果是无法签名的中心化账号，用户必须将主账号的地址或名称（参考 [RIP-2：在册名称服务](./RIPs/RIP-2.md)）放入平台账号配置的某个位置，以验证所有权，如 [RIP-1：在册账号平台](./RIPs/RIP-1.md) 所规定的。

#### 4.5.6. `profile.accounts[i].signature`

这是用来验证绑定账号的所有权，由绑定账号而不是主账号签署。

```ts
profile.accounts[i].signature = sign(`[RSS3] I am adding account ${profile.accounts[i].identifier} to my RSS3 Instance ${InstanceURI}`);
```

#### 4.5.7. `profile.tags` and `profile.metadata`

在项目实例，与 [item.tags](#_4-5-3-7-item-tags）和 [item.metadata](#_4-5-3-11-item-metadata) 相同。

## 5. 验证

### 5.1. TypeScript

```ts
// Instance
type AccountInstance = string;
type ItemInstance = string;

type Instance = AccountInstance | ItemInstance;

// URI
type InstanceURI = string;

type CustomItemListURI = string;
type AggregatedItemListURI = string;

type CustomLinkListURI = string;
type AggregatedLinkListURI = string;
type BacklinkListURI = string;

type URI = string;

// Common attributes for each files
interface Base {
    version: 'v0.4.0';
    identifier: InstanceURI | CustomItemListURI | AggregatedItemListURI | CustomLinkListURI | AggregatedLinkListURI | BacklinkListURI;
    date_created: string;
    date_updated: string;
}

interface SignedBase extends Base {
    signature: string;
    agents?: {
        pubkey: string;
        signature: string;
        authorization: string;
        app: string;
        date_expired: string;
    }[];
    controller?: string;
}

interface UnsignedBase extends Base {
    auto: true;
}

// Base types
interface Attachment {
    type?: string;
    content?: string;
    address?: URI;
    mime_type: string;
    size_in_bytes?: number;
}

interface Metadata {
    network?: NetworkName;
    proof: string;

    [key: string]: any;
}

interface Filters {
    blocklist?: string[];
    allowlist?: string[];
}

interface LinksSet {
    identifiers?: {
        type: LinkType;
        identifier_custom: CustomLinkListURI;
        identifier: AggregatedLinkListURI;
    }[];
    identifier_back: BacklinkListURI;
}

// RSS3 index files, main entrance for a instance
interface Index extends SignedBase, UnsignedBase {
    identifier: InstanceURI;

    profile?: {
        name?: string;
        avatars?: URI[];
        bio?: string;
        attachments?: Attachment[];

        accounts?: {
            identifier: InstanceURI;
            signature?: string;
        }[];

        tags?: string[];
        metadata?: Metadata;
    };

    links: LinksSet;

    items: {
        notes: {
            identifier_custom?: CustomItemListURI;
            identifier: AggregatedItemListURI;
            filters?: Filters;
        };
        assets: {
            identifier_custom?: CustomItemListURI;
            identifier: AggregatedItemListURI;
            filters?: Filters;
        };
    };
}

// items
type Item = {
    identifier: ItemInstanceURI;
    date_created: string;
    date_updated: string;

    auto?: true;
    related_urls?: string[];

    links: LinksSet;

    tags?: string[];
    authors: Account[];
    title?: string;
    summary?: string;
    attachments?: Attachment[];

    metadata?: Metadata;
};

type Link = {
    identifier_target: InstanceURI;
    type: LinkType;

    auto?: true;
    metadata?: Metadata;
};

// RSS3 list files
type ListBase<URIType, ElementType> = {
    identifier: URIType;
    identifier_next?: URIType;

    total: number;
    list?: ElementType[];
}

type CustomItemList = SignedBase & ListBase<CustomItemListURI, Item>;
type AggregatedItemList = UnsignedBase & ListBase<AggregatedItemListURI, Item>;

type CustomLinkList = (SignedBase | UnsignedBase) & ListBase<CustomLinkListURI, Link>;
type AggregatedLinkList = UnsignedBase & ListBase<AggregatedLinkListURI, Link>;
type BacklinkList = UnsignedBase & ListBase<BacklinkListURI, Link>;
```

### 5.2. JSON Schema

TODO

## 6. 用例

### 6.1. 索引文件示例

URI `rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum`

```json
{
    "version": "v0.4.0",
    "identifier": "rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum",
    "date_created": "2021-08-17T14:36:00.676Z",
    "date_updated": "2022-02-10T22:50:53.132Z",

    "signature": "0x85d66b17df7343364c6b89ede6ff15279505abfdfa7b8c70590d53a3a10db97a504b8a2536a7dcc12527af42f28f643a258d48f395b8fa5917336f06d8972be41c",
    "agents": [
        {
            "pubkey": "rrqJ2xn7oUd4wGW8VbsZk9XeacYMap4/jprIA5b35ns=",
            "signature": "PObUwUA+BEStJZJoY4xBsOkQujsRAZ4yULZIu0orDHCID2ezI5/eD8EskIK+RFNvSCp9tKTSYqurEFa2egW6Dg==",
            "authorization": "",
            "app": "Revery",
            "date_expired": "2023-02-10T22:50:53.132Z"
        }
    ],

    "profile": {
        "name": "DIYgod",
        "avatars": [
            "ipfs://QmT1zZNHvXxdTzHesfEdvFjMPvw536Ltbup7B4ijGVib7t"
        ],
        "bio": "Cofounder of RSS3.",
        "attachments": [
            {
                "type": "websites",
                "content": "https://rss3.io\nhttps://diygod.me",
                "mime_type": "text/uri-list",
            },
            {
                "type": "banner",
                "content": "ipfs://QmT1zZNHvXxdTzHesfEdvFjMPvw536Ltbup7B4ijGVib7t",
                "mime_type": "image/jpeg",
            }
        ],

        "accounts": [
            {
                "identifier": "rss3://account:0x8768515270aA67C624d3EA3B98CA464672C50183@ethereum",
                "signature": "0x4828da56a162b9504dca6009864a90ed0ca3e56256d8458af451874ad7dd9cb26be4f399a56a8b69a881297ba6b6434a7f2f4a4f3557890d1efa8490769187be1b"
            },
            {
                "identifier": "rss3://account:DIYgod@twitter"
            }
        ]
    },

    "links": {
        "identifiers": [
            {
                "type": "following",
                "identifier_custom": "rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/link/following/1",
                "identifier": "rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/link/following"
            },
        ],
        "identifier_back": "rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/backlink"
    },

    "items": {
        "notes": {
            "identifier_custom": "rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/note/0",
            "identifier": "rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/note",
            "filters": {
                "blocklist": [
                    "Twitter"
                ]
            }
        },
        "assets": {
            "identifier_custom": "rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/asset/0",
            "identifier": "rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/asset",
            "filters": {
                "allowlist": [
                    "Polygon"
                ]
            }
        }
    }
}
```

### 6.2. 链接列表文件示例

URI `rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/link/following/1`

```json
{
    "version": "v0.4.0",
    "identifier": "rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/link/following/1",
    "identifier_next": "rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/link/following/0",
    "date_created": "2021-08-17T14:36:00.676Z",
    "date_updated": "2022-02-10T22:50:53.132Z",

    "signature": "0x5b2387a7e1b2ceb1a1b0c177294ca480ec1f43a21ad627476951b0c69baece500bde043d6f3a8ff1a8e248e3216517316b397806f6a6e721df50ed43479d65651c",

    "total": 8,
    "list": [
        {
            "identifier_target": "rss3://account:0xd8dA6BF26964aF9D7eEd9e03E53415D37aA96045@ethereum",
            "type": "following"
        },
        {
            "identifier_target": "rss3://asset:1B599C2B-5153-5DFC-8909-25AE1D51E801@rss3",
            "type": "following"
        },
        {
            "identifier_target": "rss3://note:1483972580616949762@twitter",
            "type": "following"
        },
        {
            "identifier_target": "rss3://asset:0xacbe98efe2d4d103e221e04c76d7c55db15c8e89-5@ethereum",
            "type": "following"
        }
    ]
}
```

### 6.3. 资产列表文件示例

URI `rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/asset/0`

```json
{
    "version": "v0.4.0",
    "identifier": "rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/asset/0",
    "date_created": "2021-08-17T14:36:00.676Z",
    "date_updated": "2022-02-10T22:50:53.132Z",

    "signature": "0x5b2387a7e1b2ceb1a1b0c177294ca480ec1f43a21ad627476951b0c69baece500bde043d6f3a8ff1a8e248e3216517316b397806f6a6e721df50ed43479d65651c",

    "total": 1,
    "list": [
        {
            "identifier": "rss3://asset:D52DCF9F-7FF0-400A-9562-66C87DB3A866@rss3",
            "date_created": "2021-08-17T14:36:00.676Z",
            "date_updated": "2022-02-10T22:50:53.132Z",

            "links": {
                "identifier_back": "rss3://asset:D52DCF9F-7FF0-500A-9562-66C87DB3A866@rss3/list/backlink"
            },
        
            "tags": [
                "Garage Kit"
            ],
            "authors": [
                "0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum"
            ],
            "summary": "My Garage Kit - 2233",
            "attachments": [
                {
                    "address": "ipfs://QmT1zZNHvXxdTzHesfEdvFjMPvw536Ltbup7B4ijGVib7t",
                    "mime_type": "image/jpg",
                    "size_in_bytes": 1024
                }
            ]
        }
    ]
}
```

### 6.4. 帖子列表文件示例

URI `rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/note/0`

```json
{
    "version": "v0.4.0",
    "identifier": "rss3://account:0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum/list/note/0",
    "date_created": "2021-08-17T14:36:00.676Z",
    "date_updated": "2022-02-10T22:50:53.132Z",

    "signature": "0x5b2387a7e1b2ceb1a1b0c177294ca480ec1f43a21ad627476951b0c69baece500bde043d6f3a8ff1a8e248e3216517316b397806f6a6e721df50ed43479d65651c",

    "total": 1,
    "list": [
        {
            "identifier": "rss3://note:D52DCF9F-7FF0-500A-9562-66C87DB3A866@rss3",
            "date_created": "2021-08-17T14:36:00.676Z",
            "date_updated": "2022-02-10T22:50:53.132Z",

            "links": {
                "identifiers": [
                    {
                        "type": "comment",
                        "identifier_custom": "rss3://note:D52DCF9F-7FF0-500A-9562-66C87DB3A866@rss3/list/link/comment/0",
                        "identifier": "rss3://note:D52DCF9F-7FF0-500A-9562-66C87DB3A866@rss3/list/link/comment"
                    },
                ],
                "identifier_back": "rss3://note:D52DCF9F-7FF0-500A-9562-66C87DB3A866@rss3/list/backlink"
            },

            "authors": [
                "0xC8b960D09C0078c18Dcbe7eB9AB9d816BcCa8944@ethereum",
                "0x09D9719d01f48304993b35c5b5c813DdCD622362@ethereum"
            ],
            "title": "RSS3 is born",
            "summary": "RSS3 is a next-generation feed standard that aims to support efficient and decentralized information distribution.",
            "attachments": [
                {
                    "content": "# I include a markdown",
                    "mime_type": "text/markdown"
                }, {
                    "address": "ipfs://QmT1zZNHvXxdTzHesfEdvFjMPvw536Ltbup7B4ijGVib7t",
                    "mime_type": "image/jpg",
                    "size_in_bytes": 1024
                }
            ]
        }
    ]
}
```
